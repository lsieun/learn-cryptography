# ECDSA Sample

<!-- TOC -->

- [1. ECDSA-256](#1-ecdsa-256)
- [2. Reference](#2-reference)

<!-- /TOC -->

## 1. ECDSA-256

The Diffie-Hellman group is given by the elliptic curve `y^2 = (x^3 - 3 x + b) modulo p`.

The parameters for the group for this signature are

- `p`: FFFFFFFF 00000001 00000000 00000000 00000000 FFFFFFFF FFFFFFFF FFFFFFFF
- `b`: 5AC635D8 AA3A93E7 B3EBBD55 769886BC 651D06B0 CC53B0F6 3BCE3C3E 27D2604B
- `q`: FFFFFFFF 00000000 FFFFFFFF FFFFFFFF BCE6FAAD A7179E84 F3B9CAC2 FC632551

> 笔记：在代码中，我使用n来代替q。

- `gx`: 6B17D1F2 E12C4247 F8BCE6E5 63A440F2 77037D81 2DEB33A0 F4A13945 D898C296
- `gy`: 4FE342E2 FE1A7F9B 8EE7EB4A 7C0F9E16 2BCE3357 6B315ECE CBB64068 37BF51F5

> 笔记：a/b/p这三个参数是ECC需要的参数；而G/p/q这三个参数是DSA需要的参数；这两部分参数都含有p，而这两个p在ECDSA算法中使用同一个值。  
> G点，是Generator点，是在椭圆曲线上选定的“起始点”。

The static and ephemeral keys are given by

- `w`: DC51D386 6A15BACD E33D96F9 92FCA99D A7E6EF09 34E70975 59C27F16 14C88A7F

> 笔记：这个值表示私钥

- `gwx`: 2442A5CC 0ECD015F A3CA31DC 8E2BBC70 BF42D60C BCA20085 E0822CB0 4235E970
- `gwy`: 6FC98BD7 E50211A4 A27102FA 3549DF79 EBCB4BF2 46B80945 CDDFE7D5 09BBFD7D

> 笔记：这两个值表示公钥

- `k`: 9E56F509 196784D9 63D1C0A4 01510EE7 ADA3DCC5 DEE04B15 4BF61AF1 D5A6DECE
- `gkx`: CB28E099 9B9C7715 FD0A80D8 E47A7707 9716CBBF 917DD72E 97566EA1 C066957C
- `gky`: 2B57C023 5FB74897 68D058FF 4911C20F DBE71E36 99D91339 AFBB903E E17255DC

The SHA-256 hash of the message "abc" (hex 616263) is

- `h`: BA7816BF 8F01CFEA 414140DE 5DAE2223 B00361A3 96177A9C B410FF61 F20015AD

The signature of the message is `(r,s)` where

- `kinv`: AFA27894 5AF74B1E 295008E0 3A8984E2 E1C69D9B BBC74AF1 4E3AC4E4 21ABFA61
- `r`: CB28E099 9B9C7715 FD0A80D8 E47A7707 9716CBBF 917DD72E 97566EA1 C066957C
- `s`: 86FA3BB4 E26CAD5B F90B7F81 899256CE 7594BB1E A0C89212 748BFF3B 3D5B0315

The quantities required for verification of the signature are

- `sinv`: 33BDC294 E90CFAD6 2A9F2FD1 F8741DA7 7C02A573 E1B53BA1 7A60BA90 4F491952
- `u`: C3875E57 C85038A0 D60370A8 7505200D C8317C8C 534948BE A6559C7C 18E6D4CE
- `v`: 3B4E49C4 FDBFC006 FF993C81 A50EAE22 1149076D 6EC09DDD 9FB3B787 F85B6483
- `gux`: 4F749762 9362EFBB EE591206 D036568F 239789B2 34960635 C6607EC6 99062600
- `guy`: 8490E12D E4DBB68C BF941721 5D8C648E 57A8E0E4 4E176856 3CD58697 001A8D08
- `gwvx`: 726E5684 964DB8EA 341D8679 DFB70E04 EDA404E9 94BA730F A43F1E78 ED81211B
- `gwvy`: 0C10CBA8 DD2620C1 12A4F9BE 578E4BE1 E64DC0F7 D1D526CA 167749F9 CEC0DF08
- `sumx`: CB28E099 9B9C7715 FD0A80D8 E47A7707 9716CBBF 917DD72E 97566EA1 C066957C
- `sumy`: 2B57C023 5FB74897 68D058FF 4911C20F DBE71E36 99D91339 AFBB903E E17255DC

The signature is valid since `sumx` modulo `q` equals `r`.

## 2. Reference

Sample Data

- [ECDSA-256](https://tools.ietf.org/html/rfc4754#section-8)
